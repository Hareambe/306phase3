<!DOCTYPE html>
<html>
	<head>
		<title>Custom Login System</title>
		<link
			rel="stylesheet"
			href="./styles.css"
		/>
		<script src="https://www.gstatic.com/firebasejs/9.21.0/firebase-app.js"></script>
		<script src="https://www.gstatic.com/firebasejs/9.21.0/firebase-database.js"></script>
	</head>
	<body>
		<div class="container">
			<!-- LOGIN VIEW -->
			<div id="loginView">
				<h1>Login</h1>
				<form id="loginForm">
					<input
						type="text"
						id="username"
						placeholder="Username"
						required
					/><br />
					<input
						type="password"
						id="password"
						placeholder="Password"
						required
					/><br />
					<button type="submit">Login</button>
				</form>
				<br />
				<button onclick="switchView('registerView')">Register</button>
				<br />
				<button id="guestLoginButton">Login as Guest</button>
			</div>

			<!-- REGISTER VIEW -->
			<div
				id="registerView"
				class="hidden"
			>
				<h1>Register</h1>
				<form id="registerForm">
					<input
						type="text"
						id="registerUsername"
						placeholder="Enter username"
						required
					/><br />
					<input
						type="password"
						id="registerPassword"
						placeholder="Enter password"
						required
					/><br />
					<button type="submit">Register</button>
				</form>
				<br />
				<button onclick="switchView('loginView')">Back to Login</button>
			</div>

			<!-- USER VIEW -->
			<div
				id="userView"
				class="hidden"
			>
				<h1>Support Tickets</h1>

				<!-- TICKET CREATION SECTION -->
				<div class="ticket-creation">
					<label for="ticketSubject">Select the subject:</label>
					<select
						id="ticketSubject"
						required
					>
						<option value="Defected Product">
							Defected Product
						</option>
						<option value="Late Order">Late Order</option>
						<option value="Lost Product">Lost Product</option>
						<option value="Suggestion">Suggestion</option>
					</select>
					<br />
					<label for="ticketTopic">Enter the topic:</label>
					<input
						type="text"
						id="ticketTopic"
						placeholder="Brief topic for your ticket"
						required
					/>
					<br />
					<button id="createTicketButton">Create Ticket</button>
				</div>

				<!-- USER TICKET LIST -->

				<h2>Your Tickets</h2>
				<div>
					<button id="userFilterAllBtn">All Tickets</button>
					<button id="userFilterResolvedBtn">Resolved</button>
					<button id="userFilterUnresolvedBtn">Unresolved</button>
				</div>
				<div id="userTicketsContainer"></div>

				<button
					class="logout"
					onclick="logout()"
				>
					Logout
				</button>
			</div>

			<!-- ADMIN VIEW -->
			<div
				id="adminView"
				class="hidden"
			>
				<h1>Admin Dashboard</h1>
				<!-- NEW: Filter Buttons -->
				<div>
					<button id="filterAllBtn">All Tickets</button>
					<button id="filterResolvedBtn">Resolved</button>
					<button id="filterUnresolvedBtn">Unresolved</button>
				</div>
				<!-- ADMIN TICKET LIST -->
				<h2>All Tickets</h2>
				<div id="adminTicketsContainer"></div>

				<button
					class="logout"
					onclick="logout()"
				>
					Logout
				</button>
			</div>

			<!-- TICKET DETAIL VIEW (Shared by User & Admin) -->
			<div
				id="ticketDetailView"
				class="hidden"
			>
				<h1>Ticket Details</h1>
				<p>
					<strong>Ticket ID:</strong>
					<span id="ticketIdDisplay"></span>
				</p>
				<p>
					<strong>Subject:</strong>
					<span id="ticketSubjectDisplay"></span>
				</p>
				<p>
					<strong>Topic:</strong>
					<span id="ticketTopicDisplay"></span>
				</p>

				<h2>Messages</h2>
				<div id="ticketMessagesContainer"></div>
				<form id="ticketMessageForm">
					<textarea
						id="ticketMessageInput"
						placeholder="Enter your message"
						required
					></textarea>
					<br />
					<button type="submit">Send Message</button>
				</form>

				<!-- NEW: Admin Resolve Button -->
				<button
					id="resolveTicketButton"
					class="hidden"
				>
					Mark Ticket as Resolved
				</button>

				<button id="backToTicketsButton">Back to Tickets</button>
			</div>
		</div>

		<script
			type="module"
			src="./app.js"
		></script>
	</body>
</html>
